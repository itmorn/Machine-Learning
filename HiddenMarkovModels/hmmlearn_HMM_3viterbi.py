#coding=utf-8
import numpy as np
from hmmlearn import hmm

states = ["box 1", "box 2", "box3"]
n_states = len(states)

observations = ["red", "white"]
n_observations = len(observations)

start_probability = np.array([0.2, 0.4, 0.4])

transition_probability = np.array([
  [0.5, 0.2, 0.3],
  [0.3, 0.5, 0.2],
  [0.2, 0.3, 0.5]
])

emission_probability = np.array([
  [0.5, 0.5],
  [0.4, 0.6],
  [0.7, 0.3]
])

model = hmm.MultinomialHMM(n_components=n_states)
model.startprob_=start_probability
model.transmat_=transition_probability
model.emissionprob_=emission_probability

ball_picked = [0,1,0]
seen = np.array([ball_picked]).T

states_predict = model.predict(seen)

print "The ball picked:", ", ".join([observations[i] for i in ball_picked]) 
print "The ball picked:", ", ".join([states[i] for i in states_predict]) 


'''
result:
The ball picked: red, white, red
The ball picked: box3, box3, box3

给定模型和观测序列，求最有可能的对应的状态序列: box3, box3, box3
'''




